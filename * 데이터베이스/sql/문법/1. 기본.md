# SQL 기본 문법
#Database/SQL #SQL/Basic

> [!INFO]
> 이 문서는 데이터베이스와 테이블을 관리하고, 데이터를 조작(추가, 조회, 수정, 삭제)하며, 기본적인 조건 검색과 정렬을 수행하는 가장 기초적인 SQL 명령어들을 다룹니다.

## 1. 데이터베이스 관련 명령어 (DDL)

-   **데이터베이스 생성**
    ```sql
    CREATE DATABASE school;
    ```
-   **데이터베이스 선택**
    ```sql
    USE school;
    ```
-   **데이터베이스 삭제**
    ```sql
    DROP DATABASE old_school;
    ```

## 2. 테이블 관련 명령어 (DDL)

-   **테이블 생성**
    ```sql
    CREATE TABLE students (
        id INT PRIMARY KEY AUTO_INCREMENT,
        name VARCHAR(50) NOT NULL,
        age INT,
        grade FLOAT,
        enrollment_date DATE
    );
    ```
-   **테이블 구조 변경**
    ```sql
    -- 컬럼 추가
    ALTER TABLE students ADD email VARCHAR(100);
    -- 컬럼 삭제
    ALTER TABLE students DROP COLUMN age;
    -- 컬럼 타입 변경
    ALTER TABLE students MODIFY COLUMN name VARCHAR(100);
    ```

## 3. 데이터 조작 명령어 (DML)

> [!NOTE] DML (Data Manipulation Language)
> 테이블의 데이터를 직접 조작하는 명령어들입니다. (`INSERT`, `SELECT`, `UPDATE`, `DELETE`)

-   **`INSERT` - 데이터 삽입**
    ```sql
    INSERT INTO students (name, age, grade) VALUES ('김철수', 20, 4.5);
    ```
-   **`SELECT` - 데이터 조회**
    ```sql
    -- 이름과 학점 컬럼만 조회
    SELECT name, grade FROM students WHERE age > 20;
    -- 모든 컬럼 조회
    SELECT * FROM students WHERE grade >= 4.0;
    ```
-   **`UPDATE` - 데이터 수정**
    > [!WARNING] `UPDATE` 문에서 `WHERE` 절을 생략하면 테이블의 모든 데이터가 수정되므로 반드시 주의해야 합니다.
    ```sql
    UPDATE students SET grade = 4.0 WHERE name = '김철수';
    ```
-   **`DELETE` - 데이터 삭제**
    > [!WARNING] `DELETE` 문에서 `WHERE` 절을 생략하면 테이블의 모든 데이터가 삭제되므로 반드시 주의해야 합니다.
    ```sql
    DELETE FROM students WHERE grade < 2.0;
    ```

## 4. 조건절과 연산자

-   **`WHERE` - 기본 조건**
    ```sql
    -- 20세 이상이고 학점이 4.0 이상인 학생
    SELECT * FROM students WHERE age >= 20 AND grade >= 4.0;
    -- 학점이 2.0 미만이거나 4.5 초과인 학생
    SELECT * FROM students WHERE grade < 2.0 OR grade > 4.5;
    ```
-   **`LIKE` - 패턴 검색**
    ```sql
    SELECT * FROM students WHERE name LIKE '김%';  -- '김'으로 시작하는 이름
    SELECT * FROM students WHERE name LIKE '%민';  -- '민'으로 끝나는 이름
    SELECT * FROM students WHERE name LIKE '%준%'; -- '준'이 포함된 이름
    ```
-   **`IN` - 목록 내 포함 여부**
    ```sql
    SELECT * FROM students WHERE age IN (20, 21, 22);
    ```
-   **`BETWEEN` - 범위 검색**
    ```sql
    SELECT * FROM students WHERE age BETWEEN 20 AND 25;
    ```

## 5. 정렬과 제한

-   **`ORDER BY` - 정렬**
    ```sql
    -- 학점을 기준으로 내림차순(DESC) 정렬
    SELECT * FROM students ORDER BY grade DESC;
    -- 나이를 기준으로 오름차순(ASC) 정렬 후, 학점을 기준으로 내림차순 정렬
    SELECT * FROM students ORDER BY age ASC, grade DESC;
    ```
-   **`LIMIT` - 결과 개수 제한**
    ```sql
    -- 학점이 가장 높은 5명의 학생만 조회
    SELECT * FROM students ORDER BY grade DESC LIMIT 5;
    ```

## 6. 그룹화와 집계함수

-   **`GROUP BY` - 그룹화**
    ```sql
    -- 학점별 학생 수 계산
    SELECT grade, COUNT(*) FROM students GROUP BY grade;
    ```
-   **주요 집계함수**
    ```sql
    SELECT
        COUNT(*) as total_students, -- 전체 학생 수
        AVG(grade) as average_grade,  -- 평균 학점
        SUM(grade) as sum_grade,      -- 학점 총합
        MAX(grade) as highest_grade,  -- 최고 학점
        MIN(grade) as lowest_grade    -- 최저 학점
    FROM students;
    ```
-   **`ROUND` - 반올림**
    ```sql
    -- 숫자를 소수점 둘째 자리까지 반올림
    SELECT ROUND(123.456, 2);  -- 결과: 123.46
    -- 부서별 평균 급여를 소수점 둘째 자리까지 반올림하여 조회
    SELECT department, ROUND(AVG(salary), 2) as avg_salary
    FROM employees
    GROUP BY department;
    ```

## 7. 조인 (JOIN)

> [!NOTE] JOIN
> 여러 테이블에 흩어져 있는 관련 데이터를 하나로 묶어 조회하는 기능입니다.

-   **`INNER JOIN`**: 두 테이블에 모두 존재하는 데이터만 연결합니다.
    ```sql
    SELECT s.name, c.course_name
    FROM students s
    INNER JOIN enrollments e ON s.id = e.student_id
    INNER JOIN courses c ON e.course_id = c.id;
    ```
-   **`LEFT JOIN`**: 왼쪽 테이블(students)의 모든 데이터를 포함하고, 오른쪽 테이블(enrollments)은 일치하는 데이터만 연결합니다.
    ```sql
    SELECT s.name, e.course_id
    FROM students s
    LEFT JOIN enrollments e ON s.id = e.student_id;
    ```

## 8. 서브쿼리

> [!NOTE] Subquery
> 하나의 SQL 쿼리 안에 포함된 또 다른 `SELECT` 쿼리입니다.

-   **`WHERE` 절에서 사용**
    ```sql
    -- 평균 학점보다 높은 학점을 가진 학생들 조회
    SELECT * FROM students
    WHERE grade > (SELECT AVG(grade) FROM students);
    ```
-   **`FROM` 절에서 사용 (인라인 뷰)**
    ```sql
    -- 학점이 4.0을 초과하는 학생들 중에서 '김'씨 성을 가진 학생 조회
    SELECT *
    FROM (SELECT name, grade FROM students WHERE grade > 4.0) AS high_performers
    WHERE name LIKE '김%';
    ```

---
> [[00. 데이터베이스 목차.md|⬆️ 목차로 돌아가기]]