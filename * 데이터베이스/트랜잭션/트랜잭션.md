# 데이터베이스 트랜잭션 (Transaction)
#Database/Transaction #Database/ACID

> [!INFO] 트랜잭션이란?
> **트랜잭션(Transaction)**은 데이터베이스 관리 시스템(DBMS)에서 수행되는 **하나의 논리적 작업 단위**입니다. 여러 개의 쿼리가 모여 하나의 트랜잭션을 구성할 수 있으며, 이 작업 단위는 전부 성공하거나(COMMIT) 전부 실패해야(ROLLBACK) 합니다.

예를 들어, 'A가 B에게 1만 원을 송금한다'는 작업은 다음과 같은 두 개의 쿼리로 구성된 하나의 트랜잭션입니다.
1.  A의 계좌에서 1만 원을 차감한다. (`UPDATE`)
2.  B의 계좌에 1만 원을 추가한다. (`UPDATE`)

만약 1번 작업만 성공하고 시스템에 장애가 발생하면, 돈은 공중으로 사라지게 됩니다. 트랜잭션은 이러한 상황을 방지하고 데이터의 무결성을 보장합니다.

## 트랜잭션의 핵심 원칙: ACID

> [!NOTE]
> 이론적으로 모든 트랜잭션은 **원자성(Atomicity), 일관성(Consistency), 고립성(Isolation), 지속성(Durability)** 이라는 4가지 특성을 보장해야 합니다. 이 앞 글자를 따 **ACID**라고 부릅니다. 실제로는 성능 향상을 위해 일부 특성(특히 고립성)을 완화하기도 합니다.

### 1. 원자성 (Atomicity)

-   **"All or Nothing"**
-   트랜잭션에 포함된 모든 작업이 전부 성공적으로 실행되거나, 하나라도 실패하면 모든 작업이 실행 이전 상태로 되돌아가야(Rollback) 합니다.
-   즉, 트랜잭션은 더 이상 쪼갤 수 없는 하나의 원자(Atom)처럼 동작해야 합니다.

### 2. 일관성 (Consistency)

-   트랜잭션이 성공적으로 완료된 후에도 데이터베이스는 항상 **일관된 상태**를 유지해야 합니다.
-   데이터베이스에 정의된 모든 규칙과 제약 조건(기본 키, 외래 키, NOT NULL 등)을 위반하지 않아야 합니다.
-   예: 송금 트랜잭션 후에도 A 계좌와 B 계좌의 총액은 트랜잭션 이전과 동일해야 합니다.

### 3. 고립성 (Isolation)

-   여러 트랜잭션이 동시에 실행될 때, 각 트랜잭션은 서로에게 영향을 주지 않고 **독립적으로 실행되는 것처럼 보여야** 합니다.
-   하나의 트랜잭션이 실행되는 동안, 다른 트랜잭션은 그 중간 결과를 볼 수 없습니다.
-   고립성을 어느 수준까지 보장할 것인지에 따라 '트랜잭션 격리 수준(Isolation Level)'이 나뉩니다.

### 4. 지속성 (Durability)

-   성공적으로 완료된(COMMIT된) 트랜잭션의 결과는 시스템에 장애가 발생하더라도 **영구적으로 저장**되어야 합니다.
-   데이터베이스는 보통 WAL(Write-Ahead Log)나 저널링(Journaling) 같은 메커니즘을 통해 이를 보장합니다.

---
> [[00. 데이터베이스 목차.md|⬆️ 목차로 돌아가기]]
> [[트랜잭션 격리 수준/트랜잭션 격리 수준.md|➡️ 다음: 트랜잭션 격리 수준]]