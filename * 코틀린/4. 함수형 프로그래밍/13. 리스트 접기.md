# fold와 reduce: 컬렉션 접기
#Kotlin/Functional

> [!INFO] 접기(Folding)란?
> **접기(Folding)**는 컬렉션(리스트, 집합 등)의 모든 원소를 순회하며, 지정된 연산을 통해 **하나의 누적된 결과값**으로 축약하는 함수형 프로그래밍의 핵심 연산입니다.

코틀린에서는 `fold`와 `reduce`라는 두 가지 주요 함수를 통해 이 기능을 제공합니다.

## 1. `fold`

-   **동작**: **초기값**을 기준으로, 컬렉션의 첫 번째 원소부터 마지막 원소까지 순서대로 누적 연산을 수행합니다.
-   **문법**: `list.fold(initial) { accumulator, element -> ... }`
    -   `initial`: 누적 연산의 시작점이 되는 초기값.
    -   `accumulator`: 이전 단계까지의 연산 결과가 누적된 값.
    -   `element`: 현재 처리 중인 컬렉션의 원소.

### 예제: 합계 구하기
```kotlin
val numbers = listOf(1, 2, 3, 4, 5)

// 초기값 0부터 시작하여 모든 원소를 더함
val sum = numbers.fold(0) { acc, num ->
    println("acc: $acc, num: $num")
    acc + num
}
println("Sum: $sum") // 출력: Sum: 15
```
> **실행 과정:**
> acc: 0, num: 1
> acc: 1, num: 2
> acc: 3, num: 3
> acc: 6, num: 4
> acc: 10, num: 5

## 2. `reduce`

-   **동작**: **컬렉션의 첫 번째 원소**를 초기값으로 사용하여, 두 번째 원소부터 마지막 원소까지 순서대로 누적 연산을 수행합니다.
-   **문법**: `list.reduce { accumulator, element -> ... }`

### 예제: 최댓값 찾기
```kotlin
val numbers = listOf(3, 9, 4, 7)

// 첫 번째 원소(3)를 초기 acc 값으로 시작
val max = numbers.reduce { acc, num ->
    println("acc: $acc, num: $num")
    if (acc > num) acc else num
}
println("Max: $max") // 출력: Max: 9
```
> **실행 과정:**
> acc: 3, num: 9
> acc: 9, num: 4
> acc: 9, num: 7

## 3. `fold` vs `reduce`

| 구분 | `fold` | `reduce` |
| :--- | :--- | :--- |
| **초기값** | **필수**. 직접 지정 | **없음**. 컬렉션의 첫 번째 원소를 사용 |
| **빈 컬렉션 처리** | **안전**. 초기값을 그대로 반환 | **예외 발생** (`UnsupportedOperationException`) |
| **반환 타입** | 초기값과 동일한 타입 | 컬렉션의 원소와 동일한 타입 |

> [!IMPORTANT]
> 처리할 컬렉션이 비어 있을 가능성이 있다면, 런타임 예외를 방지하기 위해 **`reduce` 대신 `fold`를 사용**하는 것이 더 안전하고 바람직합니다.

## 4. `foldRight`와 `reduceRight`

`fold`와 `reduce`는 컬렉션의 왼쪽(첫 번째 원소)에서 오른쪽으로 연산을 수행합니다. 반대로 오른쪽에서 왼쪽으로 연산을 수행하고 싶을 때는 `foldRight`와 `reduceRight`를 사용할 수 있습니다.

```kotlin
val numbers = listOf(1, 2, 3)

// ((3 - 2) - 1) 이 아닌 (1 - (2 - 3)) 순서로 계산됨
val result = numbers.reduceRight { num, acc -> num - acc }
println(result) // 출력: 2 (1 - (-1))
```

---
> [[00. 코틀린 목차.md|⬆️ 목차로 돌아가기]]
> [[12. 지역 함수.md|⬅️ 이전: 지역 함수]] | [[14. 재귀.md|➡️ 다음: 재귀]]