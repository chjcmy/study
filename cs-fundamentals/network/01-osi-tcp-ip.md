# OSI 7계층 & TCP/IP

---

## OSI 7계층 모델

```
7. 응용 계층 (Application)     ← HTTP, HTTPS, FTP, DNS, WebSocket
6. 표현 계층 (Presentation)    ← 암호화/복호화, 인코딩 (TLS/SSL)
5. 세션 계층 (Session)         ← 연결 관리, 세션 유지
4. 전송 계층 (Transport)       ← TCP, UDP (포트 번호)
3. 네트워크 계층 (Network)     ← IP, 라우팅 (IP 주소)
2. 데이터링크 계층 (Data Link) ← 이더넷, Wi-Fi (MAC 주소)
1. 물리 계층 (Physical)        ← 케이블, 전기 신호
```

### 각 계층 상세

| 계층 | 핵심 역할 | 프로토콜/장비 | 데이터 단위 |
|------|----------|-------------|-----------|
| 7. 응용 | 사용자 인터페이스, 서비스 제공 | HTTP, FTP, SMTP, DNS | 메시지 |
| 6. 표현 | 데이터 포맷 변환, 암호화 | TLS/SSL, JPEG, JSON | 메시지 |
| 5. 세션 | 연결 설정/유지/해제 관리 | NetBIOS, RPC | 메시지 |
| 4. 전송 | 종단 간 신뢰성 있는 전송 | TCP, UDP | **세그먼트** |
| 3. 네트워크 | 라우팅, 논리 주소 지정 | IP, ICMP, ARP | **패킷** |
| 2. 데이터링크 | 물리 주소 지정, 에러 감지 | Ethernet, Wi-Fi | **프레임** |
| 1. 물리 | 비트 전송, 전기/광 신호 | 케이블, 허브 | **비트** |

### 데이터 캡슐화 과정

```
[송신 측 — 캡슐화]

응용 계층:    │ HTTP 요청 데이터 │
                    ↓ 아래로 내려가며 헤더 추가
전송 계층:    │TCP 헤더│ 데이터 │              ← 세그먼트
                    ↓
네트워크:    │IP 헤더│TCP 헤더│ 데이터 │       ← 패킷
                    ↓
데이터링크:  │MAC 헤더│IP│TCP│ 데이터 │FCS│    ← 프레임
                    ↓
물리:        01101001 10110100 ...              ← 비트


[수신 측 — 역캡슐화]
비트 → 프레임 → 패킷 → 세그먼트 → 데이터 (헤더 하나씩 제거)
```

### 면접 핵심 포인트

```
Q: 왜 계층으로 나누는가?
A: 1. 각 계층이 독립적 → 한 계층 변경이 다른 계층에 영향 ❌
   2. 표준화 → 서로 다른 벤더 장비도 통신 가능
   3. 트러블슈팅 용이 → "어느 계층에서 문제인가?"

Q: 실무에서 OSI 7계층을 쓰나?
A: 이론적 모델이고, 실제로는 TCP/IP 4계층을 사용
```

---

## TCP/IP 4계층 (실제 인터넷)

```
OSI 7계층                    TCP/IP 4계층
─────────────                ─────────────
7. 응용                      4. 응용 계층
6. 표현       ────→             (HTTP, DNS, TLS, SSH)
5. 세션

4. 전송       ────→          3. 전송 계층
                                (TCP, UDP)

3. 네트워크   ────→          2. 인터넷 계층
                                (IP, ICMP, ARP)

2. 데이터링크  ────→          1. 네트워크 접근 계층
1. 물리                         (이더넷, Wi-Fi)
```

### OSI vs TCP/IP 차이

| 구분 | OSI | TCP/IP |
|------|-----|--------|
| 계층 수 | 7개 | 4개 |
| 성격 | 이론적 참조 모델 | 실용적 구현 모델 |
| 개발 | ISO | DARPA (미 국방부) |
| 세션/표현 | 별도 계층 | 응용 계층에 통합 |
| 사용 | 교육/면접 | **실무/개발** |

---

## 실전 OSI 매핑 (웹 요청 예시)

```
브라우저 → 웹 서버 HTTPS 요청 시:

7. 응용     HTTP GET /api/users              ← JSON API 요청
6. 표현     TLS 1.3 암호화                    ← HTTPS 암호화/복호화
5. 세션     TCP 세션 유지 (Keep-Alive)        ← HTTP/1.1 연결 재사용
4. 전송     TCP 3-way handshake              ← 포트 443
3. 네트워크  IP 라우팅                         ← 라우터 → 서버까지
2. 링크     이더넷/Wi-Fi                      ← MAC 주소 기반 전달
1. 물리     케이블/광섬유/무선                 ← 전기/광/전파 신호
```

### 트러블슈팅 시 계층별 점검

```
502 Bad Gateway 발생 시:

7계층 확인: API 코드 오류?          → 서버 로그 확인, 응답 형식 확인
4계층 확인: 포트가 열려있나?        → telnet/netstat으로 포트 확인
3계층 확인: IP 라우팅이 맞나?       → ping, traceroute로 경로 확인
2계층 확인: 네트워크 연결 자체가 됐나? → 케이블, 스위치, ARP 테이블 확인
```
