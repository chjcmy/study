# 02 조건부 확률과 독립성: 정보가 주어졌을 때의 추론

## 1. 조건부 확률 (Conditional Probability)

**조건부 확률**은 **어떤 사건 B가 일어났다는 새로운 정보가 주어졌을 때, 다른 사건 A가 일어날 확률**을 의미합니다. 즉, 정보가 추가되면서 확률이 어떻게 변하는지를 다룹니다.

-   **표기**: $P(A|B)$
    -   "사건 B가 일어났을 때(given)의 사건 A의 확률"이라고 읽습니다.
-   **정의**:
    $$ P(A|B) = \frac{P(A \cap B)}{P(B)} $$
    -   $P(A \cap B)$: 사건 A와 B가 동시에 일어날 확률 (교집합)
    -   $P(B)$: 사건 B가 일어날 확률
-   **의미**: 전체 표본 공간이 사건 B라는 새로운 공간으로 축소되었을 때, 그 안에서 A가 일어나는 비율을 보는 것과 같습니다.

**예시**:
-   $P(	ext{비가 옴})$: 내일 비가 올 일반적인 확률
-   $P(	ext{비가 옴 | 구름이 많음})$: 오늘 하늘에 구름이 많다는 정보가 주어졌을 때, 내일 비가 올 확률. (일반적으로 더 높을 것입니다)

## 2. 사건의 독립 (Independence)

**사건의 독립**은 한 사건의 발생이 다른 사건의 발생 확률에 **아무런 영향을 주지 않는** 경우를 의미합니다.

-   **정의**:
    $$ P(A|B) = P(A) $$
    -   사건 B가 일어나든 말든 사건 A의 확률은 변하지 않습니다.
-   **독립일 때의 곱셈 정리**: 두 사건 A와 B가 서로 독립이면, 두 사건이 동시에 일어날 확률은 각 사건의 확률을 곱한 것과 같습니다.
    $$ P(A \cap B) = P(A)P(B) $$
-   **예시**:
    -   동전을 두 번 던질 때, 첫 번째 던진 결과는 두 번째 던질 결과에 영향을 주지 않습니다.
    -   주사위를 던지고 동전을 던질 때, 두 사건은 서로 독립입니다.

## 3. 베이즈 정리 (Bayes' Theorem): 추론의 핵심

**베이즈 정리**는 조건부 확률을 이용하여, **결과를 관찰한 후 원인의 확률을 추론**하는 강력한 도구입니다.

-   **정의**:
    $$ P(A|B) = \frac{P(B|A)P(A)}{P(B)} $$
-   **용어**:
    -   $P(A|B)$: **사후 확률 (Posterior)**. 사건 B가 발생한 후의 사건 A의 확률. (우리가 최종적으로 알고 싶은 것)
    -   $P(A)$: **사전 확률 (Prior)**. 사건 B와 관계없이 우리가 이미 알고 있는 사건 A의 확률.
    -   $P(B|A)$: **우도 (Likelihood)**. 사건 A가 일어났을 때 사건 B가 일어날 확률.
    -   $P(B)$: **증거 (Evidence)**. 사건 B의 전체 확률.

**예시**:
-   $A$: 환자가 특정 질병에 걸렸다.
-   $B$: 환자가 양성 판정을 받았다.
-   $P(A|B)$: 양성 판정을 받았을 때, 실제로 그 질병에 걸렸을 확률. (우리가 진짜 궁금한 것)
-   $P(A)$: 전체 인구 중 그 질병에 걸린 사람의 비율 (사전 확률).
-   $P(B|A)$: 실제로 병에 걸린 사람이 양성 판정을 받을 확률 (우도, 진단 키트의 민감도).

베이즈 정리는 사전 지식(Prior)에 새로운 증거(Likelihood)를 결합하여, 더 합리적인 사후 추론(Posterior)을 가능하게 합니다.

## 4. AI와의 연결점

-   **나이브 베이즈 분류기 (Naive Bayes Classifier)**: 베이즈 정리를 기반으로 하는 간단하면서도 강력한 분류 알고리즘입니다. 이메일의 여러 단어들('광고', '당첨', '무료' 등)이 주어졌을 때, 이 메일이 스팸일 확률을 계산합니다. 여기서 핵심은 모든 단어들이 서로 **독립이라고 과감하게 가정**하는 것입니다. 이 가정 덕분에 계산이 매우 빠르고 효율적입니다.

-   **베이지안 통계 (Bayesian Statistics)**: AI의 한 축을 이루는 베이지안 통계학의 모든 이론은 베이즈 정리에 기반합니다. 이는 모델의 파라미터 자체를 확률 변수로 보고, 데이터를 관찰함에 따라 파라미터의 확률 분포를 업데이트해 나가는 방식으로 불확실성을 다룹니다.

---

## 5. 확인 문제 (Practice Problems)

1.  **조건부 확률**: 한 학급에 30명의 학생이 있고, 그 중 10명은 안경을 썼습니다. 안경을 쓴 학생 중 6명은 남학생입니다. 만약 이 학급에서 임의로 한 명을 뽑았는데 안경을 쓴 학생이었다면, 그 학생이 남학생일 조건부 확률은 얼마일까요?

2.  **독립**: 주사위를 두 번 던질 때, 첫 번째 던져서 짝수가 나오는 사건과 두 번째 던져서 홀수가 나오는 사건은 서로 독립일까요?

3.  **베이즈 정리**: 어떤 질병의 발병률($P(A)$)이 1%라고 합니다. 이 질병에 대한 진단 키트는 병에 걸린 사람을 99%의 확률로 양성($P(B|A)$)으로 판정합니다. 만약 어떤 사람이 이 키트로 양성 판정을 받았다면, 그 사람이 실제로 병에 걸렸을 확률($P(A|B)$)을 계산하는 데 필요한 정리는 무엇인가요?

---
*조건부 확률과 독립성, 그리고 이를 기반으로 한 베이즈 정리는 AI가 불완전한 정보 속에서 합리적인 추론을 하고, 새로운 데이터를 통해 기존의 믿음을 업데이트하는 학습 과정을 수학적으로 설명하는 핵심 원리입니다.*