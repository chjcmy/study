# 04 삼각 함수 (Trigonometric Functions): 주기와 순서의 언어

## 1. 삼각 함수의 정의: 단위원 위의 회전

삼각 함수는 직각삼각형의 변의 비율에서 출발했지만, 함수로서의 특징은 **단위원(Unit Circle, 반지름이 1인 원)** 위를 움직이는 점의 좌표로 이해하는 것이 가장 좋습니다.

-   각도 $\theta$가 주어졌을 때, 단위원 위의 점의 좌표는 $(\cos\theta, \sin\theta)$ 입니다.
-   **$\cos\theta$**: 점의 $x$좌표.
-   **$\sin\theta$**: 점의 $y$좌표.
-   **$\tan\theta$**: 원점과 점을 잇는 직선의 기울기 ($\\sin\theta / \\cos\theta$).

### 주요 특징

-   **주기성 (Periodicity)**: 각도가 $360^\circ$ (또는 $2\pi$ 라디안)만큼 회전하면 점의 위치가 원래대로 돌아옵니다. 이 때문에 삼각 함수는 일정한 패턴이 반복되는 **주기 함수**입니다. $\\sin(x) = \\sin(x + 2\pi)$, $\\cos(x) = \\cos(x + 2\pi)$.
-   **범위 (Range)**: 단위원 위의 점이므로, $x$좌표($\\cos\theta$)와 $y$좌표($\\sin\theta$)는 절대 -1보다 작거나 1보다 클 수 없습니다. 즉, 치역은 $[-1, 1]$ 입니다.

## 2. 삼각 함수와 AI: 주기성과 위치를 모델링하다

삼각 함수의 가장 중요한 특징인 '주기성'은 AI가 세상의 반복되는 패턴과 순서 정보를 학습하는 데 매우 강력한 도구를 제공합니다.

### 시계열 데이터 분석 (Time-Series Analysis)

-   **계절성 모델링**: 많은 시계열 데이터는 주기적인 패턴을 가집니다. 예를 들어, 아이스크림 판매량은 여름마다 급증하는 연간 주기를, 전력 사용량은 낮 시간에 증가하는 일간 주기를 보입니다.
-   **푸리에 변환 (Fourier Transform)**: 복잡한 시계열 신호를 여러 개의 단순한 $\\sin$과 $\\cos$ 함수의 합으로 분해하는 기법입니다. 이를 통해 데이터에 숨겨진 다양한 주기(계절성, 트렌드 등)를 발견하고 분석할 수 있습니다.

### 위치 인코딩 (Positional Encoding) in Transformers

자연어 처리 모델인 **트랜스포머(Transformer)**는 문장을 단어들의 집합으로 처리하기 때문에, "고양이가 강아지를 쫓는다"와 "강아지가 고양이를 쫓는다"를 구분하지 못하는 문제가 있습니다. 모델에게 단어의 **순서 정보**를 알려주기 위한 방법이 바로 **위치 인코딩**입니다.

-   **왜 삼각 함수인가?**: 트랜스포머는 각 단어의 위치(position)에 해당하는 고유한 벡터를 만들기 위해 $\\sin$과 $\\cos$ 함수를 사용합니다.
    $$ PE_{(\text{pos}, 2i)} = \\sin(\frac{\text{pos}}{10000^{2i/d_{\text{model}}}}) $$
    $$ PE_{(\text{pos}, 2i+1)} = \\cos(\frac{\text{pos}}{10000^{2i/d_{\text{model}}}}) $$
    여기서 `pos`는 단어의 위치, `i`는 벡터의 차원 인덱스입니다.

-   **삼각 함수의 장점**:
    1.  **고유한 위치 값**: 각 위치(`pos`)마다 고유한 인코딩 벡터 값을 가집니다.
    2.  **상대적 위치 관계**: 삼각 함수의 덧셈 정리에 의해, 특정 위치의 인코딩은 다른 위치의 인코딩과의 선형 변환으로 표현될 수 있습니다. 이는 모델이 단어 간의 상대적인 거리(예: "3칸 앞에 있는 단어")를 쉽게 학습할 수 있도록 돕습니다.
    3.  **안정적인 범위**: 출력값이 항상 $[-1, 1]$ 사이로 안정적입니다.
    4.  **외삽 능력**: 학습된 문장보다 더 긴 문장이 들어와도 위치 인코딩을 생성할 수 있습니다.

이처럼 삼각 함수는 트랜스포머가 단어의 절대적, 상대적 위치 정보를 이해하고 문장의 의미를 정확히 파악하는 데 결정적인 역할을 합니다.

---

## 3. 확인 문제 (Practice Problems)

1.  **주기성**: $\\sin(x)$ 함수의 주기는 $2\pi$ 입니다. 그렇다면 $\\sin(2x)$ 함수의 주기는 어떻게 될까요? 더 짧아질까요, 길어질까요?

2.  **범위**: 어떤 신경망 모델의 출력 중 하나가 $y = \\cos(z)$ 형태로 계산됩니다. 이 출력 $y$가 가질 수 있는 값의 범위는 무엇일까요?

3.  **위치 인코딩 개념**: 트랜스포머 모델이 단어의 순서 정보를 학습하기 위해 삼각 함수를 사용하는 가장 중요한 이유는 무엇일까요? (힌트: 상대적 위치)

--- 
*삼각 함수는 단순히 삼각형의 변의 비율을 넘어, 세상의 모든 주기적인 현상과 데이터의 순서를 표현하는 정교한 언어입니다.*
