# 제4단원: TensorFlow & Keras 실전 구현 (기초 완전판)

1~3단원에서 **신경망 구조·학습 원리·3대 요소(활성화/손실/옵티마이저)**를 이론으로 봤습니다.[file:2][file:7]  
이제 이 이론을 **코드로 어떻게 구현하는지**를 TensorFlow & Keras로 단계별 정리합니다.[file:3]

---

## 1. 딥러닝 모델 개발의 표준 5단계 (Life Cycle)

딥러닝 모델을 만드는 과정은 **요리 레시피**와 비슷하게  
항상 같은 흐름을 반복합니다.[file:3]

> Define → Compile → Fit → Evaluate → Predict  
> (정의 → 컴파일 → 학습 → 평가 → 예측)

각 단계의 역할은 다음과 같습니다.[file:3]

1. **모델 정의 (Define)**  
   - 어떤 층(Layer)들을 어떤 순서로 쌓을지 결정.  
   - 신경망의 “뼈대” 설계 단계.

2. **컴파일 (Compile)**  
   - 옵티마이저(Adam, SGD), 손실 함수(MSE, Cross-Entropy), 평가 지표(Accuracy 등)를 설정.  
   - “어떻게 공부하고, 어떻게 채점할지” 정하는 단계.[file:3]

3. **학습 (Fit)**  
   - 학습 데이터(X_train, y_train)를 넣고 여러 Epoch 동안 가중치 w를 업데이트.  
   - 실제로 **순전파 + 역전파 + 옵티마이저**가 돌아가는 단계.[file:3][file:2]

4. **평가 (Evaluate)**  
   - 한 번도 보지 못한 검증/테스트 데이터로 성능 점수를 계산.  
   - 과적합인지, 일반화가 잘 되는지 확인.[file:3][file:8]

5. **추론 (Predict)**  
   - 완성된 모델에 새 데이터를 넣고 **실제 서비스에서 예측 결과**를 사용.  
   - 예: “이 꽃은 90% 확률로 A 품종입니다.”[file:3]

---

## 2. 단계별로 조금 더 자세히 보기

여기서는 코드 느낌까지 상상할 수 있도록, 각 단계의 역할을 구체적으로 풀어봅니다.[file:3]

### 1단계: 모델 정의 (Define) – 신경망 뼈대 만들기

- **무엇을 하는 단계인가?**  
  - 레고 블록처럼 층(Layer)을 차곡차곡 쌓아서  
    “입력 → 은닉층들 → 출력층” 구조를 만드는 단계입니다.[file:3]
- **핵심 개념**  
  - `Sequential` 모델: 층을 순서대로 쌓는 가장 단순한 형태.  
  - **층 종류 예시**  
    - `Dense`: 완전연결층(MLP에서 사용하는 기본 층).  
    - 활성화 함수: ReLU(은닉층), Softmax(출력층) 등.[file:2][file:3]

설계 느낌은 이런 식입니다.

- 입력층: 특징 개수에 맞추어 설정  
- 은닉층: 뉴런 개수와 활성화 함수(ReLU 등) 결정  
- 출력층: 문제 유형에 따라 뉴런 수 & 활성화 함수(Softmax / Sigmoid / Linear) 결정[file:3]

> 이 단계까지는 “모양만 잡는 것”이고, 아직 공부(학습)는 시작하지 않은 상태입니다.

---

### 2단계: 컴파일 (Compile) – 공부 방식과 채점 방식 정하기

- **하는 일**  
  - 모델이 **어떤 기준으로 공부하고, 무엇을 목표로 할지**를 설정합니다.[file:3]
- **설정 항목**  
  1. **옵티마이저 (optimizer)**  
     - 예: `adam`, `sgd`  
     - 3단원에서 봤듯이, 가중치를 어떻게 업데이트할지 결정.[file:2]
  2. **손실 함수 (loss)**  
     - 분류인지 회귀인지에 따라 선택.  
     - 예:  
       - 회귀: `mse`  
       - 이진 분류: `binary_crossentropy`  
       - 다중 분류: `categorical_crossentropy`[file:2][file:3]
  3. **평가 지표 (metrics)**  
     - 학습 중/후에 어떤 숫자를 보며 성능을 판단할지.  
     - 예: `accuracy`, `mae` 등.[file:3]

> 한마디로, 컴파일 단계에서  
> **“선생님(옵티마이저) + 채점표(손실 함수) + 성적표 형식(지표)”**를 한 번에 정해 둡니다.

---

### 3단계: 학습 (Fit) – 진짜로 공부시키는 단계

- **하는 일**  
  - 준비한 학습 데이터를 모델에 넣어,  
    **Epoch(에포크)**만큼 반복해서 순전파·역전파를 수행하며 가중치를 최적화합니다.[file:3][file:7]
- **중요 개념**  
  - **Epochs**  
    - “훈련용 데이터 전체를 몇 번 반복해서 볼 것인가”  
    - 예: `epochs=10` → 전체 학습 데이터를 10번 돌려서 학습.  
  - **Batch size**  
    - 한 번의 업데이트에 사용하는 데이터 묶음 크기.  
    - 너무 크면 메모리 부담, 너무 작으면 노이즈 큼.

이 단계에서 딥러닝의 핵심인  
**순전파 → 손실 계산 → 역전파 → 옵티마이저로 가중치 업데이트**  
루프가 매번 실행됩니다.[file:7][file:2]

---

### 4단계: 평가 (Evaluate) – 시험 보기

- **하는 일**  
  - 학습에 사용하지 않은 **검증/테스트 데이터**를 모델에 넣어서  
    손실 값과 정확도(또는 다른 지표)를 계산합니다.[file:3]
- **목적**  
  - 학습 데이터만 외운 상태(과적합, Overfitting)가 아닌지 확인.[file:8]  
  - 실전에서 어느 정도 성능이 나올지 미리 가늠.

> 여기서 성능이 안 좋으면,  
> - 모델 구조 변경  
> - 전처리 개선  
> - Epoch 수 조정  
> - Dropout 추가(5단원 내용)  
> 등을 다시 시도하게 됩니다.

---

### 5단계: 추론 (Predict) – 서비스에 투입

- **하는 일**  
  - 이미 학습이 끝난 모델에 **새로운 데이터**를 넣고 예측 결과를 얻습니다.[file:3]
- **예시**  
  - 꽃의 길이·너비가 들어오면 → “품종 A일 확률 0.8, B 0.15, C 0.05”  
  - 집의 특징이 들어오면 → “예상 집값 3.2억”  
- 이 단계에서는 **가중치 업데이트(학습)**는 하지 않고,  
  그냥 **순전파만 수행**하여 결과를 내놓습니다.

---

## 3. 실전 예제로 보는 4단원 개념

문서에서 언급한 대표 예제 두 개를 간단히 연결해 보면 이렇게 됩니다.[file:3]

### (1) 붓꽃(Iris) 품종 분류 – 다중 분류 예제

- **문제 유형:** 다중 클래스 분류 (3종류 꽃 분류)  
- **구성 요약**  
  - 입력: 꽃의 특징 4가지 (꽃잎 길이/너비 등)  
  - 출력층: 뉴런 3개 (각 품종), 활성화 함수 **Softmax**[file:3]  
  - 손실 함수: 다중 분류 → **Categorical Cross-Entropy**[file:3]
- **5단계 흐름**  
  - Define: Dense 층 쌓기 (입력 4 → 은닉층(ReLU) → 출력 3(Softmax))  
  - Compile: optimizer=Adam, loss=categorical_crossentropy, metrics=['accuracy']  
  - Fit: 여러 Epoch 동안 학습  
  - Evaluate: 테스트 세트 정확도 확인  
  - Predict: 새 꽃 데이터에 대해 품종 예측

---

### (2) 보스턴 집값 예측 – 회귀 예제

- **문제 유형:** 회귀 (숫자 예측)  
- **구성 요약**  
  - 입력: 지역 정보 13가지 특징  
  - 출력층: 뉴런 1개, 활성화 함수 **Linear** (값을 그대로 출력)[file:3]  
  - 손실 함수: 숫자 예측 → **MSE (Mean Squared Error)**[file:3]
- **5단계 흐름**  
  - Define: Dense 층 쌓기 (입력 13 → 은닉층들 → 출력 1(Linear))  
  - Compile: optimizer=Adam, loss=mse, metrics=['mae'] (평균 절대 오차 등)  
  - Fit: 여러 Epoch 학습  
  - Evaluate: 테스트 세트 MSE/MAE 확인  
  - Predict: 새 집의 특징으로 예상 집값 예측

---

### 💡 개념 체크 Quiz

Q. 딥러닝 모델 개발 5단계 중에서,  
실제 학습 데이터(X_train, y_train)를 넣고  
여러 Epoch 동안 가중치 \( w \)를 업데이트하는 단계는?  

A) 컴파일 (Compile)  
B) 학습 (Fit)  
C) 평가 (Evaluate)  

👉 **정답: B**  
`model.fit(...)` 단계에서 순전파·역전파·옵티마이저가 반복 실행되며 실제 학습이 진행됩니다.[file:3]

---

## [4단원 핵심 정리]

1. 딥러닝 구현은 **Define → Compile → Fit → Evaluate → Predict**의 5단계 라이프사이클을 따른다.[file:3]  
2. **컴파일** 단계에서 3단원의 내용(옵티마이저·손실 함수·지표)을 구체적인 값으로 설정한다.[file:2][file:3]  
3. 분류 문제(Softmax + Cross-Entropy)와 회귀 문제(Linear + MSE)는  
   **출력층 설계와 손실 함수 선택이 다르다**는 점을 꼭 기억해야 한다.[file:3]

---

👉 다음은 **제5단원: 데이터 전처리 & 과적합/드롭아웃** 완전판으로 이어서 정리해 줄까?
