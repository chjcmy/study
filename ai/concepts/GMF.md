# Generalized Matrix Factorization (GMF)

## ğŸ“Œ ê°œë… (Concept)
ê¸°ì¡´ì˜ **Matrix Factorization (MF)**ë¥¼ ì‹ ê²½ë§ì˜ ê´€ì ì—ì„œ ì¼ë°˜í™”(Generalize)í•œ ê²ƒì…ë‹ˆë‹¤. 

- **í•µì‹¬ ì—­í• **: **"ì„ í˜•ì (Linear) ìƒí˜¸ì‘ìš© í•™ìŠµ"**
- **ìˆ˜ì‹**: $\hat{y}_{ui} = \sigma(h^T (p_u \odot q_i))$
- **íŠ¹ì§•**: MFëŠ” GMFì˜ íŠ¹ìˆ˜í•œ í˜•íƒœë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## âš™ï¸ êµ¬ì¡° (Architecture)
1.  **Embedding**: ìœ ì €ì™€ ì•„ì´í…œì„ ë²¡í„°ë¡œ ë³€í™˜.
2.  **Element-wise Product (ìš”ì†Œë³„ ê³±)**: 
    - ì¼ë°˜ì ì¸ MFëŠ” ë‚´ì (Dot Product)ì„ í•˜ì—¬ ë°”ë¡œ ìŠ¤ì¹¼ë¼ ê°’(ì ìˆ˜) í•˜ë‚˜ë¥¼ ë§Œë“­ë‹ˆë‹¤.
    - GMFëŠ” ë‘ ë²¡í„°ë¥¼ ìš”ì†Œë³„ë¡œ ê³±í•´ì„œ **ê°™ì€ ì°¨ì›ì˜ ë²¡í„°**ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
    - ì˜ˆ: `[1, 2] * [3, 4] = [3, 8]`
3.  **Output Layer**: ìš”ì†Œë³„ ê³±ì˜ ê²°ê³¼ë¥¼ ì„ í˜• ë ˆì´ì–´(Linear)ì— í†µê³¼ì‹œì¼œ ìµœì¢… ì ìˆ˜ë¥¼ ë§Œë“­ë‹ˆë‹¤. (MFëŠ” ì—¬ê¸°ì„œ ë‹¨ìˆœíˆ ëª¨ë“  ìš”ì†Œë¥¼ ë”í•˜ëŠ” ê²ƒê³¼ ê°™ìŒ)

## ğŸ’¡ ì¶”ì²œ ì‹œìŠ¤í…œì—ì„œì˜ í™œìš©
- **NCF**: NCF ëª¨ë¸ì˜ í•œ ì¶•ì„ ë‹´ë‹¹í•˜ë©°, ìœ ì €ì™€ ì•„ì´í…œì˜ ê¸°ë³¸ì ì¸ ë§¤ì¹­ ì •ë³´ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤. MLPê°€ ë†“ì¹  ìˆ˜ ìˆëŠ” ë‹¨ìˆœí•˜ê³  ëª…í™•í•œ íŒ¨í„´ì„ ì˜ ì¡ìŠµë‹ˆë‹¤.

## ğŸ’» ì½”ë“œ ì˜ˆì‹œ (PyTorch)
```python
# ìœ ì €ì™€ ì•„ì´í…œ ì„ë² ë”© (í¬ê¸° 32)
user_emb = nn.Embedding(num_users, 32)
item_emb = nn.Embedding(num_items, 32)

# GMF ì—°ì‚° (ìš”ì†Œë³„ ê³±)
gmf_vector = user_emb(user_idx) * item_emb(item_idx)

# ìµœì¢… ì˜ˆì¸¡ (ë²¡í„° -> ì ìˆ˜)
prediction = nn.Linear(32, 1)(gmf_vector)
```
