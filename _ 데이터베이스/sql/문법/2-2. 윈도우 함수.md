# SQL 윈도우 함수
#Database/SQL #SQL/Advanced

## 2. 윈도우 함수 (Window Functions)

> [!NOTE] Window Functions
> `GROUP BY`와 달리 행을 집계하지 않고, 각 행에 대해 순위, 누적 값, 비율 등을 계산하는 강력한 분석 함수입니다. `OVER()` 절과 함께 사용됩니다.

-   **순위 함수**: `ROW_NUMBER()`, `RANK()`, `DENSE_RANK()`
    ```sql
    SELECT
        name,
        grade,
        RANK() OVER (ORDER BY grade DESC) as rank,
        DENSE_RANK() OVER (ORDER BY grade DESC) as dense_rank
    FROM students;
    ```
-   **분석 함수**: `LAG()` (이전 행), `LEAD()` (다음 행)
    ```sql
    SELECT
        date,
        value,
        LAG(value, 1, 0) OVER (ORDER BY date) as previous_value,
        LEAD(value, 1, 0) OVER (ORDER BY date) as next_value
    FROM time_series;
    ```
-   **`PARTITION BY`**: 그룹 내에서 윈도우 함수를 적용합니다.
    ```sql
    -- 각 부서(department) 내에서 급여 순위 매기기
    SELECT
        name,
        salary,
        department,
        RANK() OVER (PARTITION BY department ORDER BY salary DESC) as rank_in_dept
    FROM employees;
    ```

---
> [[00. 데이터베이스 목차.md|⬆️ 목차로 돌아가기]]
> [[2-1. WITH 절 (CTE).md|⬅️ 이전: WITH 절 (CTE)]] | [[2-3. 고급 조인.md|➡️ 다음: 고급 조인]]