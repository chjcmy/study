# SQL 잠금 (Lock) 관리
#Database/SQL #SQL/SpecialFeatures

> [!INFO]
> 이 문서는 데이터베이스의 성능, 안정성, 보안을 최고 수준으로 관리하기 위한 특수 기능들을 다룹니다. 잠금, 쿼리 최적화, 복제, 감사 등 DBA(데이터베이스 관리자)의 영역에 가까운 고급 주제를 포함합니다.

## 1. 잠금(Lock) 관리

> [!NOTE] 잠금(Lock)
> 여러 트랜잭션이 동일한 데이터에 동시에 접근하여 발생하는 문제를 막기 위한 메커니즘입니다.

-   **명시적 잠금**: 개발자가 직접 특정 데이터나 테이블에 잠금을 거는 기능입니다.
    -   **행 잠금 (Row-level Lock)**: 특정 행에만 잠금을 겁니다. 동시성 확보에 유리합니다.
        ```sql
        -- 다른 트랜잭션이 이 행을 수정하지 못하도록 배타적 잠금을 설정
        SELECT * FROM my_table WHERE id = 1 FOR UPDATE;

        -- 다른 트랜잭션이 이 행에 공유 잠금을 거는 것은 허용하지만, 수정은 막음
        SELECT * FROM my_table WHERE id = 1 LOCK IN SHARE MODE;
        ```
    -   **테이블 잠금 (Table-level Lock)**: 테이블 전체에 잠금을 겁니다.
        ```sql
        LOCK TABLES my_table WRITE; -- 쓰기 잠금
        UNLOCK TABLES; -- 잠금 해제
        ```
-   **잠금 상태 확인**: 현재 잠금 상태나 잠금 대기(Lock Wait) 상태를 모니터링합니다.
    ```sql
    -- InnoDB 잠금 대기 상태 확인
    SELECT * FROM information_schema.INNODB_LOCK_WAITS;
    ```

---
> [[00. 데이터베이스 목차.md|⬆️ 목차로 돌아가기]]
> [[3-6. 역할 기반 권한 관리 (RBAC).md|⬅️ 이전: 역할 기반 권한 관리 (RBAC)]] | [[4-2. 쿼리 최적화 기법.md|➡️ 다음: 쿼리 최적화 기법]]