# 안전한 호출과 엘비스 연산자
#Kotlin/NullSafety

> [!INFO]
> 코틀린은 `NullPointerException`(NPE)을 컴파일 시점에 방지하기 위해 **널 안정성(Null Safety)** 이라는 강력한 시스템을 갖추고 있습니다. **안전한 호출(`?.`)**과 **엘비스 연산자(`?:`)**는 널 안정성을 지키는 핵심 도구입니다.

## 1. 안전한 호출 연산자 (`?.`)

-   **역할**: 널이 될 수 있는(nullable) 타입의 변수에서 프로퍼티나 함수에 접근할 때 사용합니다.
-   **동작**:
    -   객체가 `null`이 **아니면**, 일반적인 호출처럼 멤버에 접근합니다.
    -   객체가 `null`**이면**, 멤버에 접근하지 않고 즉시 `null`을 반환합니다.

이를 통해 `if (variable != null)` 체크를 간결하게 대체할 수 있습니다.

```kotlin
val str: String? = "Kotlin"
println(str?.length) // 출력: 6

val nullStr: String? = null
println(nullStr?.length) // 출력: null (NPE가 발생하지 않음!)
```

### 체이닝 (Chaining)

안전한 호출은 여러 개를 연결하여 사용할 수 있습니다. 체인 중간에 하나라도 `null`이 있으면, 전체 결과는 `null`이 됩니다.

```kotlin
// user -> address -> street -> length
val streetLength = user?.address?.street?.length
```

## 2. 엘비스 연산자 (`?:`)

-   **역할**: 널(null)일 경우 사용할 기본값을 지정합니다.
-   **동작**:
    -   왼쪽의 표현식이 `null`이 **아니면**, 해당 표현식의 결과를 그대로 사용합니다.
    -   왼쪽의 표현식이 `null`**이면**, 연산자 오른쪽의 값을 사용합니다.

> [!TIP]
> 엘비스 프레슬리의 옆모습과 닮았다고 해서 '엘비스 연산자'라는 이름이 붙었습니다. `:)`

```kotlin
val str: String? = null

// str이 null이면 "Unknown"을, 아니면 str의 값을 사용
val result: String = str ?: "Unknown"
println(result) // 출력: Unknown
```

## 3. 안전한 호출과 엘비스 연산자의 조합

이 두 연산자를 함께 사용하면, "값이 있으면 사용하고, 없으면 기본값을 사용"하는 로직을 매우 간결하고 안전하게 작성할 수 있습니다.

```kotlin
val str: String? = null

// str?.length가 null이면 0을 반환
val length: Int = str?.length ?: 0
println(length) // 출력: 0
```

이는 아래의 `if-else` 문과 동일한 코드입니다.
```kotlin
val length: Int
if (str != null) {
    length = str.length
} else {
    length = 0
}
```

### `return` 또는 `throw`와 함께 사용

엘비스 연산자의 우항에는 값뿐만 아니라, 함수를 종료시키는 `return`이나 예외를 던지는 `throw`도 위치할 수 있습니다.

```kotlin
fun process(user: User?) {
    // user가 null이면 함수를 즉시 종료
    val name = user?.name ?: return

    println("Processing $name...")
}

fun getCity(user: User?): String {
    // address가 null이면 예외 발생
    return user?.address?.city ?: throw IllegalArgumentException("No city found")
}
```

---
> [[00. 코틀린 목차.md|⬆️ 목차로 돌아가기]]
> [[9. 널이 될 수 있는 타입.md|⬅️ 이전: 널이 될 수 있는 타입]] | [[11. 널 아님 단언.md|➡️ 다음: 널 아님 단언]]