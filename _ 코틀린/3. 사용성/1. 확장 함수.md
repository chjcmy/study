# 확장 함수 (Extension Functions)
#Kotlin/Extension

> [!INFO] 확장 함수란?
> **확장 함수(Extension Function)**는 상속이나 데코레이터 패턴 없이, **기존 클래스의 소스 코드를 수정하지 않고도** 새로운 함수를 추가할 수 있는 코틀린의 강력한 기능입니다.

마치 원래 그 클래스에 포함된 멤버 함수인 것처럼 점(`.`)을 찍어 호출할 수 있어, 코드의 가독성과 재사용성을 크게 향상시킵니다.

## 1. 기본 문법

확장 함수는 `fun [확장할 클래스 이름].[함수 이름]()` 형태로 선언합니다. 함수 내부에서는 `this` 키워드를 사용하여 수신 객체(확장 대상이 된 객체)의 `public` 멤버에 접근할 수 있습니다.

```kotlin
// String 클래스에 addExclamation 함수를 확장
fun String.addExclamation(): String {
    return this + "!" // this는 수신 객체, 즉 "Hello" 문자열을 가리킴
}

fun main() {
    val message = "Hello"
    // String 클래스의 멤버 함수처럼 호출
    println(message.addExclamation()) // 출력: Hello!
}
```

## 2. 확장 함수의 동작 원리

> [!IMPORTANT] 확장 함수는 정적으로 결정된다
> 확장 함수는 실제 클래스의 코드를 변경하는 것이 아닙니다. 컴파일 시점에, 확장 함수는 **수신 객체를 첫 번째 인자로 받는 정적 메소드**로 변환됩니다.
>
> 따라서, 어떤 확장 함수가 호출될지는 컴파일 시점에 선언된 변수의 타입에 의해 결정되며, 런타임에 실제 객체의 타입에 따라 달라지지 않습니다(다형성이 적용되지 않음).

```kotlin
open class Shape
class Circle : Shape()

fun Shape.getName() = "Shape"
fun Circle.getName() = "Circle"

fun printShapeName(shape: Shape) {
    println(shape.getName())
}

fun main() {
    // shape 변수의 선언된 타입은 Shape 이므로, Shape.getName()이 호출됨
    val shape: Shape = Circle()
    printShapeName(shape) // 출력: Shape
}
```

## 3. 확장 함수의 주요 특징 및 규칙

-   **멤버 함수 우선**: 만약 확장하려는 클래스에 동일한 시그니처의 멤버 함수가 이미 존재한다면, **항상 멤버 함수가 우선적으로 호출**됩니다.
-   **캡슐화 유지**: 확장 함수는 수신 객체 클래스의 `private`이나 `protected` 멤버에는 접근할 수 없습니다.
-   **널 가능한 타입 확장**: `?`를 붙여 널 가능한 타입에 대해서도 확장을 정의할 수 있습니다. 이는 `null` 체크 로직을 캡슐화하는 데 매우 유용합니다.

    ```kotlin
    fun String?.isBlankOrNull(): Boolean {
        return this == null || this.isBlank()
    }

    val emptyString: String? = ""
    val nullString: String? = null

    println(emptyString.isBlankOrNull()) // 출력: true
    println(nullString.isBlankOrNull())  // 출력: true
    ```

## 4. 확장 프로퍼티 (Extension Properties)

함수와 마찬가지로, 프로퍼티도 확장할 수 있습니다. 단, 값을 저장할 **백킹 필드(Backing Field)가 없으므로** 반드시 `val`로 선언하고 `get()`을 구현해야 합니다.

```kotlin
val String.lastChar: Char
    get() = this[this.length - 1]

fun main() {
    val text = "Kotlin"
    println(text.lastChar) // 출력: n
}
```

---
> [[00. 코틀린 목차.md|⬆️ 목차로 돌아가기]]
> [[17. 레이블.md|⬅️ 이전: 레이블]] | [[2. 이름 붙은 인자와 디폴트 인자.md|➡️ 다음: 이름 붙은 인자와 디폴트 인자]]